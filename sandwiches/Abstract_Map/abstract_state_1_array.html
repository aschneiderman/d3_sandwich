<DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Abstract State Map: Basic Recipe</title>
  <script src="http://d3js.org/d3.v3.min.js"></script>        <!-- d3 library -->
  <link href="../../sandwich.css" rel="stylesheet" media="screen">      <!-- sandwich's CSS -->
  <script src="abstract_state.js"></script>
  <style media="screen">
  table#strawberry, table#strawberry, td {
    border: 1px solid  #98bf21;
    border-collapse: collapse;
    font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
  }

  table.input_table, th.input_table, table.input_table td {
    border-style: none;
  }

  </style>
</head>
<body>
  <div id="container">

    <div id="sandwich-heading">
      <h1> <img src="../../sandwich_icon.jpeg"  height="50" width="50">  d3 sandwich </h1>
      <div id="sandwich-border"></div>
    </div>

      <h2> Abstract State Map</h2><h2>Step #1: Store State Data in an Array </h2>
          <div class="home_row">
            <div class="home_column1">
      <h3>	What Data Do We Need to Create the Map?</h3>
      <p>You could create an abstract state map by manually writing code for every state rectangle and state label on the map. But there's a much easier way: create  a table that contains the data needed to create the map.</p>

<p> What data do we need to  create the map? Well, the abstract state map is essentially a grid:</p>
      <table id="strawberry">
      <tr><td>Row &nbsp;</td><td>&nbsp;0 &nbsp;</td><td>&nbsp;1 &nbsp;</td><td width="150" style="text-align: center"> &nbsp; 2 &nbsp; 3  &nbsp;  4  &nbsp; 5  &nbsp; 6 &nbsp; </td><td>&nbsp;7 &nbsp;</td><td>&nbsp;8 &nbsp;</td><td>&nbsp;9 &nbsp;</td><td> 10&nbsp;</td></tr>
      <tr><td>0</td><td> </td><td> </td><td style="text-align: center"> ...</td><td> </td><td> </td><td> </td><td>ME</td></tr>
      <tr><td>1</td><td> </td><td> </td><td style="text-align: center"> ...</td><td> </td><td> </td><td> VT</td><td>NH</td></tr>
      <tr><td>2</td><td> WA</td><td> ID</td><td style="text-align: center"> ...</td><td> </td><td> NY</td><td> MA</td><td></td></tr>
      </table>

      </div>
      <div class="home_column2" class="homepage_picture"> <img align=left width=400 height=266
       src= "abstract_state_snapshot.jpg" />
      </div>
    </div>
    <br/>

    <p> So for each state, you need to know:</p>
<ul><li> The state's <b>name</b> (e.g., "WA")</li>
<li> The state's <b>row</b> on the grid (e.g., 2)</li>
<li> the state's <b>column</b> on the grid (e.g., 0)</li></ul>


<div class="recipe_row">
  <div class="recipe_text">
<h3>Playing with the Code</h3>
<p> Here's a chunk of the code that stores the info needed to create the state map (we only included 6 states to make it more manageable).</p>

<p> Before we explain what each line does, let's spend a little time playing with it. Try changing a few states' rows and columns and see what happens to the map.</p>
</div>
<div class="recipe_code">
  <br/>    <!-- br is a temp fix; fix the css so it isn't needed -->
<pre>
<b>var  state_map = [</b>
  <b id="ME_code">{ "state": "ME", "row": 0, "col": 10 }</b>,
  <b id="VT_code">{ "state": "VT", "row": 1, "col": 9 }</b>,
  <b id="NH_code">{ "state": "NH", "row": 1, "col": 10 }</b>,
  <b id="WA_code">{ "state": "WA", "row": 2, "col": 0 }</b>,
  <b id="ID_code">{ "state": "ID", "row": 2, "col": 1 }</b>,
  <b id="NY_code">{ "state": "NY", "row": 2, "col": 8 }</b>,
<b>];</b></pre>
</div>
</div>  <!-- end recipe_row -->


<div class="recipe_row">
  <div class="recipe_text">

    <svg width="500" height="160" id="selected_states" class="SVG_playground"></svg>        <!-- SVG graphics will go here  -->
  <script type="text/javascript">
  var selected_states = [];
  var  state_map = [
      { "state": "ME", "row": 0, "col": 10 },
      { "state": "VT", "row": 1, "col": 9 },
      { "state": "NH", "row": 1, "col": 10 },
      { "state": "WA", "row": 2, "col": 0 },
      { "state": "ID", "row": 2, "col": 1 },
      { "state": "NY", "row": 2, "col": 8 },
  ];

  var x_offset = 0, y_offset=0, text_offset = 10;
  make_map('#selected_states', state_map, selected_states,x_offset, y_offset);

  var width = 40, height = 40, cellsize = 39;


function updateRow(state, input_text)  {
  var row = input_text.value;
  var selected_state = [{'state': state}];
  var states =  d3.select('#selected_states');
  states.selectAll("rect")
    .data( selected_state, function(d) { return d.state; })
    .attr("y", function(d,i) {return row * height + y_offset;})
  selected = states.selectAll("text")
    .data( selected_state, function(d) { return d.state; });
  selected.attr("y", function(d,i) {return row * height + 26 + y_offset;});

  state_code = '#' + state + "_code";
  col = rr = d3.select('#ME_col')[0][0].value;
  new_code = '    { "state": "' + state + '", "row": ' + row + ', "col":'+ col + ' }';
  d3.select(state_code).text(new_code ).style("background-color", '#FFFF66');
  // d3.select(state_code).text("row is now:  " + value ).style("background-color", '#FFFF66');
};

function updateCol(state, input_text)  {
  var col = input_text.value;
  var selected_state = [{'state': state}];
  var states =  d3.select('#selected_states');
  states.selectAll("rect")
    .data( selected_state, function(d) { return d.state; })
    .attr("x", function(d,i) {return col * width  + x_offset;})
  states.selectAll("text")
    .data( selected_state, function(d) { return d.state; })
      .attr("x", function(d,i)  { return col * width + text_offset  + x_offset;});
};
</script>

</div>
<div class="recipe_code">
  <form>
    <table class="input_table">
      <tr><td>
        State
      </td><td>
        Row
      </td><td>
        Column
      </td>
      </tr>
      <tr>
        <td>ME</td>
        <td ><input type="text" class="state_input" value="0"  onChange="updateRow('ME', this)"></td>
        <td><input type="text" class="state_input" id='ME_col' value="10" onChange="updateCol('ME', this)"></td>
      </tr>
      <tr>
        <td>VT</td>
        <td><input type="text" class="state_input" value="1"  onChange="updateRow('VT', this)"></td>
        <td><input type="text" class="state_input" value="9"  onChange="updateCol('VT', this)"></td>
      </tr>
      <tr>
        <td>NH</td>
        <td><input type="text" class="state_input" value="1"  onChange="updateRow('NH', this)"></td>
        <td><input type="text" class="state_input" value="10" onChange="updateCol('NH', this)"></td>
      </tr>
      <tr>
        <td>WA</td>
        <td><input type="text" class="state_input" value="2"  onChange="updateRow('WA', this)"></td>
        <td><input type="text" class="state_input" value="0" onChange="updateCol('WA', this)"></td>
      </tr>
      <tr>
        <td>ID</td>
        <td><input type="text" class="state_input" value="2"  onChange="updateRow('ID', this)"></td>
        <td><input type="text" class="state_input" value="1" onChange="updateCol('ID', this)"></td>
      </tr>
      <tr>
        <td>NY</td>
        <td><input type="text" class="state_input" value="2"  onChange="updateRow('NY', this)"></td>
        <td><input type="text" class="state_input" value="8" onChange="updateCol('NY', this)"></td>
      </tr>
    </table>
  </form>
</div>
</div>  <!-- end recipe_row -->

<h3>Understanding the Code</h3>
    <p>To understand how the code works, you need to understand 3 concepts: </p>

<div class="recipe_row">
  <div class="recipe_text">
    <h4>We Store the Map Data in a Variable: state_map</h4>
    <p>In D3, to store data we create a <b> variable</b>. We called our variable state_map: </p>
<ul><li><b>var</b> tells D3 to create a variable</li>
  <li> Why did we call it "state_map" instead of "state map"?  Because  a variable's name can't have a space in it</li>
<li> How does JavaScript know when we're done defining the variable state_map? Because all the way at the end there's a semi-colon  -- it's like putting a period at the end of a sentence</li></ul>
</div>
<div class="recipe_code">
  <br/>    <!-- br is a temp fix; fix the css so it isn't needed -->
<pre>
  <b>var  state_map =</b> [
      { "state": "ME", "row": 0, "col": 10 },
      { "state": "VT", "row": 1, "col": 9 },
      { "state": "NH", "row": 1, "col": 10 },
      { "state": "WA", "row": 2, "col": 0 },
      { "state": "ID", "row": 2, "col": 1 },
      { "state": "NY", "row": 2, "col": 8 }
  ]<b>;</b>
</pre>
</div>
</div>  <!-- recipe_row -->

<div class="recipe_row">
  <div class="recipe_text">
<h4>state_map Is an Array </h4>

  <p> An <b>array</b> is basically just a list – in this case a list of the states.
<ul><li>We tell D3 we want to create an array by using <b>brackets</b>:  []  </li>
  <li>Each item in the array is separated by a <b>comma</b></li></ul>
</div>
<div class="recipe_code">
  <br/>    <!-- br is a temp fix; fix the css so it isn't needed -->
<pre>
  var  state_map = [
      <b>{ "state": "ME", "row": 0, "col": 10 },
      { "state": "VT", "row": 1, "col": 9 },
      { "state": "NH", "row": 1, "col": 10 },
      { "state": "WA", "row": 2, "col": 0 },
      { "state": "ID", "row": 2, "col": 1 },
      { "state": "NY", "row": 2, "col": 8 }</b>
  ];
</pre>
</div>
</div>  <!-- recipe_row -->

<div class="recipe_row">
  <div class="recipe_text">
    <h4>state_map Is an Array of Objects</h4>

<p> Because we want to store several pieces of info for each state, each item in the array will
  be an <b>object</b>.</p>
  <ul>
  <li>We tell D3 we want to create an object by using <b> curly brackets</b>: {}</li>
  <li> Each piece of an object's info is called called an <b>attribute</b>. Our state objects have 3 attributes:</li>
  <ul><li> state: WA</li>
  <li> row: 2</li>
  <li>col: 0</li></ul>
  </ul>
  <p> If you look back at the grid at the top of the page, you'll see that this object captures all the info D3 needs to know to put the state of Washington (WA) on the map. <p>

    </div>
    <div class="recipe_code">
      <br/>    <!-- br is a temp fix; fix the css so it isn't needed -->
    <pre>
          <b>{ "state": "WA", "row": 2, "col": 0 }</b>,
</pre>
    </div>
    </div>  <!-- recipe_row -->

<br/>    <!-- br is a temp fix; fix the css so it isn't needed -->
<h3>D3 Sandwich Motto: Don't Sweat It</h3>
<p>If you feel like you understand how the code to create state_map works, that's great.</p>
<p>If you're not entirely sure, that's ok:  <b>don't sweat it</b></p>
<p>
  It takes most folks a while to really understand D3 code.  At this point, all you need is a very
  rough idea of how it works.  </p>

  <p>Try playing with the states one more time, then go on to the
  next recipe step.
</p>
<h4> Up Next: <a href="abstract_state_rects.html">Recipe Step #2: Using the Array to Create the States on the Map</a></h4>

        <div id= "sandwich_footer">
        </div>
      </div>
    </body>
    </html>
